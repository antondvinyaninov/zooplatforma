# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ó–æ–æ–ë–∞–∑—ã

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞

1. **JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - Bearer —Ç–æ–∫–µ–Ω—ã
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏—Ö –ø–∏—Ç–æ–º—Ü–µ–≤
3. **CORS —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π origins** - —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã
4. **Middleware –Ω–∞ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö routes** - /api/pets —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –¢–µ—Å—Ç 1: –ó–∞–ø—Ä–æ—Å –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 401)

```bash
curl -i http://localhost:8100/api/pets
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
HTTP/1.1 401 Unauthorized
{"success": false, "error": "Unauthorized: authentication required"}
```

### –¢–µ—Å—Ç 2: –ó–∞–ø—Ä–æ—Å —Å X-User-ID (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
curl -H "X-User-ID: 1" http://localhost:8100/api/pets | jq
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "success": true,
  "data": [...]
}
```

### –¢–µ—Å—Ç 3: –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —á—É–∂–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞

```bash
# –°–æ–∑–¥–∞—Ç—å –ø–∏—Ç–æ–º—Ü–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 1
curl -X POST \
  -H "X-User-ID: 1" \
  -H "Content-Type: application/json" \
  -d '{"name":"–¢–µ—Å—Ç–æ–≤—ã–π –ø–∏—Ç–æ–º–µ—Ü","species":"–°–æ–±–∞–∫–∞"}' \
  http://localhost:8100/api/pets

# –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∏–∑–º–µ–Ω–∏—Ç—å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 2 (–¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 403)
curl -i -X PUT \
  -H "X-User-ID: 2" \
  -H "Content-Type: application/json" \
  -d '{"name":"–í–∑–ª–æ–º–∞–Ω–Ω–æ–µ –∏–º—è","species":"–°–æ–±–∞–∫–∞"}' \
  http://localhost:8100/api/pets/1
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
HTTP/1.1 403 Forbidden
{"success": false, "error": "Forbidden: you can only edit your own pets"}
```

### –¢–µ—Å—Ç 4: –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å —á—É–∂–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞

```bash
curl -i -X DELETE \
  -H "X-User-ID: 2" \
  http://localhost:8100/api/pets/1
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
HTTP/1.1 403 Forbidden
{"success": false, "error": "Forbidden: you can only delete your own pets"}
```

### –¢–µ—Å—Ç 5: –ó–∞–ø—Ä–æ—Å —Å –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω–æ–≥–æ origin

```bash
curl -i -H "Origin: http://evil-site.com" http://localhost:8100/api/pets
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
HTTP/1.1 403 Forbidden
Forbidden origin
```

### –¢–µ—Å—Ç 6: –ü—É–±–ª–∏—á–Ω—ã–µ endpoints (–±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)

```bash
# –í–∏–¥—ã - –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
curl http://localhost:8100/api/species | jq

# –ü–æ—Ä–æ–¥—ã - –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
curl http://localhost:8100/api/breeds | jq

# Health check
curl http://localhost:8100/api/health | jq
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —É—Å–ø–µ—à–Ω—ã (200 OK)

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

–ó–∞–ø—É—Å—Ç–∏—Ç–µ backend –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

```bash
cd petbase/backend
~/go/bin/air
```

–ü—Ä–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
‚ö†Ô∏è Blocked request from unauthorized origin: http://evil-site.com
```

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ X-User-ID (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø—Ä–∏ update/delete
- CORS —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π origins
- –ü—É–±–ª–∏—á–Ω—ã–µ endpoints –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### ‚è≥ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- JWT —Ç–æ–∫–µ–Ω—ã (–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, –Ω—É–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Å–∞–π—Ç–æ–º)
- Rate limiting
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

### üîí –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

1. **–°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª:**
```bash
cp petbase/backend/.env.example petbase/backend/.env
```

2. **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å JWT secret:**
```bash
openssl rand -base64 32
```

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env:**
```env
JWT_SECRET=–≤–∞—à-—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π-–∫–ª—é—á
ALLOWED_ORIGINS=https://yoursite.com,https://petbase.yoursite.com
```

4. **–£–¥–∞–ª–∏—Ç—å X-User-ID –ø–æ–¥–¥–µ—Ä–∂–∫—É** –∏–∑ middleware/auth.go (–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ JWT)

5. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS** (Let's Encrypt)

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Å–∞–π—Ç–æ–º

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å JWT —Ç–æ–∫–µ–Ω –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞

```typescript
// main/frontend - –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞
const response = await fetch('/api/auth/login', {
  method: 'POST',
  body: JSON.stringify({ email, password })
});

const { token } = await response.json();
localStorage.setItem('auth_token', token);
```

### –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ –ó–æ–æ–ë–∞–∑–µ

```typescript
import { petBaseAPI } from '@/lib/petbase-api';

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω
petBaseAPI.setAuthToken(token);

// –¢–µ–ø–µ—Ä—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
const pets = await petBaseAPI.getPets();
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω (–ø—Ä–∏–º–µ—Ä)
TOKEN="your-jwt-token"

# –ó–∞–ø—Ä–æ—Å —Å —Ç–æ–∫–µ–Ω–æ–º
curl -H "Authorization: Bearer $TOKEN" http://localhost:8100/api/pets | jq
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

```bash
lsof -i :8100
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
tail -f petbase/backend/logs/app.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
sqlite3 database/data.db "SELECT COUNT(*) FROM pets;"
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **X-User-ID –∑–∞–≥–æ–ª–æ–≤–æ–∫** - —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –Ω–µ–±–µ–∑–æ–ø–∞—Å–µ–Ω –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
2. **–ù–µ—Ç rate limiting** - –≤–æ–∑–º–æ–∂–Ω—ã DDoS –∞—Ç–∞–∫–∏
3. **–ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö** - –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π** - —Å–ª–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å rate limiting
3. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
5. –ü—Ä–æ–≤–µ—Å—Ç–∏ penetration testing
6. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
