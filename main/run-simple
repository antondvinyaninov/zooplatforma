#!/bin/bash

# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Go bin Ğ² PATH
export PATH=$PATH:$(go env GOPATH)/bin

# ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Main Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
# Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹

echo "ğŸš€ Starting Main Project (Simple Mode)..."

# ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ²
lsof -ti:7100 | xargs kill -9 2>/dev/null || true
lsof -ti:8100 | xargs kill -9 2>/dev/null || true
lsof -ti:8000 | xargs kill -9 2>/dev/null || true
lsof -ti:3000 | xargs kill -9 2>/dev/null || true

# ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° ĞºÑÑˆĞ°
rm -rf frontend/.next 2>/dev/null || true

# Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
echo "ğŸ” Starting Auth Service..."
(cd ../auth/backend && go run .) &

echo "ğŸ¾ Starting PetBase Service..."
(cd ../petbase/backend && go run .) &

sleep 3

echo "ğŸ”§ Starting Main Backend..."
(cd backend && air) &

sleep 3

echo "âš›ï¸  Starting Main Frontend..."
(cd frontend && npm run dev) &

sleep 3

echo ""
echo "âœ… Main Project started!"
echo ""
echo "   ğŸŒ Main Frontend:   http://localhost:3000"
echo "   ğŸ”§ Main Backend:    http://localhost:8000"
echo "   ğŸ¾ PetBase Service: http://localhost:8100"
echo "   ğŸ” Auth Service:    http://localhost:7100"
echo ""
echo "Press Ctrl+C to stop"

wait
